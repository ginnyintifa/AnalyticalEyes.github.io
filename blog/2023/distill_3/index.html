<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Understanding PCA deeper | Ginny Xiaohe Li </title> <meta name="author" content="Ginny Xiaohe Li"> <meta name="description" content="Deeper than most data analysts."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ginnyintifa.github.io/blog/2023/distill_3/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Understanding PCA deeper",
            "description": "Deeper than most data analysts.",
            "published": "June 25, 2023",
            "authors": [
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Ginny Xiaohe</span> Li </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">events </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Understanding PCA deeper</h1> <p>Deeper than most data analysts.</p> </d-title> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#why-pca">Why PCA?</a> </div> <div> <a href="#pca-as-a-way-to-explain-variance-in-the-data">PCA as a way to explain variance in the data</a> </div> <div> <a href="#pca-and-covariance-matrix">PCA and covariance matrix</a> </div> <div> <a href="#pca-and-singular-value-decompostion">PCA and singular value decompostion</a> </div> <div> <a href="#glue-together-with-some-experiment-in-r">Glue together with some experiment in R</a> </div> </nav> </d-contents> <h2 id="why-pca">Why PCA?</h2> <p>Whenever I get a big data table, with features in rows and sample in columns, I would like to first see how the samples are clustered or distributed in the feature space in an unsupervised way. However, feature space can be huge, and not visualizable in this 3D world. PCA is a go-to choice to achieve a lower dimension (2 or 3) summerisation/representation of the original matrix. In a 2D space, the x axis could be the first principal component (PC) of the data and the y axis could be the second PC. I make a scatter plot, projecting the data points (samples) to these two axis.</p> <p>And I would color the data points regarding to some sample meta information, for example, tissue type, experiment batch, gender, marker mutation status. This type of visualization is usually very informative in many ways. It tells me if the features capture the intrinsic differences/characteristics of the samples, or in QC, I can directly spot batch effect if there is any. Even better, I would investigate the loadings of the PCs to see which features contribute how much and to what direction of these PCs.</p> <p>$$$ maybe a PCA example</p> <h2 id="pca-as-a-way-to-explain-variance-in-the-data">PCA as a way to explain variance in the data</h2> <p>When a data analyst is asked to interpret a PCA plot, for example the above one. He or she would probably say, samples are clustered according to their tissue type along the first PC and according to xx along the second PC, the first PC explains xx% of the total variance and the second explains xx%. In total we are examining xx% of the variance.</p> <p>We know that PCs are linear combinations of the original features and the first PC would explain more variance than the second one and the second would explain more than the third one. But how are these linear combinations determined and why they “explain” variance? As you may know, PCs are orthogonal to each other, and why is that? And how many PCs would there be for each data matrix?</p> <h2 id="pca-and-the-sample-covariance-matrix">PCA and the sample covariance matrix</h2> <p>Let’s say the data matarix is $D$, with $p$ rows (features) and $n$ samples after you center the data such that features for each sample has mean at zero, you can get a centered matrix $X$. To calculate sample covariance matrix you can just easily calculate the matrix product ${1 \over n-1}XX^T$. Let’s ignore the scalar for now. $XX^T$ would be a $p$ by $p$ symmetric matrix.</p> <p>Why is the covariance matrix important? Because it basically telling you the relationships between each pair of samples using ALL the features.</p> <p>Let’s make $A = XX^T$. In linear algebra, a symmetric matrix has some very good properties. For one, it can be factorized as $A = Q\Lambda Q^T$. Where $Q$ is an orthogonal matrix, of which the columns are the eigenvectors of $A$. $\Lambda$ is a diagonal matrix with the eigenvalues of $A$ on its diagonal.</p> <p>And there are some very interesting properties of eigenvalues and eigenvectors. Basically they can capture the most fundamental characteristics of a matrix. And why is that?</p> <p>@@@ I need to better explain this part</p> <p>Ok, now it seems we have explored the calculation behind PCA. But what how is it actually processed in a modern computation program?</p> <p>Singular value decomposition!</p> <h2 id="pca-and-singular-value-decompostion">PCA and singular value decompostion</h2> <p>It is very computationally expensive to calculate the covariance matrix, especially with dimensions are large. Singular value decomposition (SVD) comes in handy because there are fast and efficient ways to do that decomposition. What’s better, SVD can be performed on any matrix (no need to be symmetric, even no need to be a square matrix).</p> <p>So for our centered data matrix $X$, we can SVD it to this form:</p> <p>$X = U\Sigma V^T$</p> <p>Here, $U$ and $V$ are two orthogonal matrices, and $\Sigma$ is a diagonal matrix. This is exactly why math is elegant. For any matrix, you can view its impact as a rotation ($U$), followed by a strech ($\Sigma$), followed by another rotation ($V^T$).</p> <p>Then what about the our covariance matrix?</p> <p>$XX^T = (U\Sigma V^T)(U\Sigma V^T)^T = U\Sigma V^TV\Sigma^TU^T = U\Sigma^2U^T$</p> <p>Note that the last equation is because $U$ is orthagonal.</p> <p>And guess what, we already know :</p> <p>$A = XX^T = Q\Lambda Q^T$</p> <p>So now we have:</p> <p>$U\Sigma^2U^T = Q\Lambda Q^T$</p> <p>Naturally we have:</p> <p>$U = Q$ and $\Sigma^2 = \Lambda$</p> <p>This derivation tells us, if we want to get the eigenvalues and vectors of the covariance matrix, we just need to do a SVD on the centered data matrix. Isn’t that wonderful?</p> <h2 id="glue-together-with-some-experiment-in-r">Glue together with some experiment in R</h2> <p>You are probably famillar with the <code class="language-plaintext highlighter-rouge">prcomp</code> function in R. <code class="language-plaintext highlighter-rouge">svd</code> is the base function in R for SVD calculation. And let’d do a simple experiment to see the relationship between SVD and PCA analysis.</p> <p>Supose we have such a simple matrix $X$</p> <p>$\begin{bmatrix}3 &amp; 4 &amp; 2\4 &amp; 6 &amp; 1\ 2 &amp; 5 &amp; 7\ 6 &amp; 7&amp; 2\2 &amp; 1&amp;4 \end{bmatrix}$</p> <p>3 samples and 5 features.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'ginnyintifa/ginnyintifa.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Ginny Xiaohe Li. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>